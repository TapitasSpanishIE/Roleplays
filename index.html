<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LC Spanish Master - Se√±or Mart√≠n</title>
    <style>
        :root { --primary: #1a237e; --secondary: #c62828; }
        body { font-family: sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; background: #e5ddd5; }
        
        header { background: var(--primary); color: white; padding: 15px; text-align: center; flex-shrink: 0; }
        
        /* Botones de Role Play m√°s grandes para iPad */
        .selector { display: flex; overflow-x: auto; gap: 10px; padding: 10px; background: #fff; border-bottom: 2px solid #ccc; flex-shrink: 0; }
        .rp-btn { min-width: 80px; padding: 12px; background: #f0f0f0; border: 1px solid #999; border-radius: 8px; font-weight: bold; font-size: 14px; text-align: center; cursor: pointer; }
        .active { background: var(--secondary) !important; color: white; }

        #chat { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .bubble { max-width: 80%; padding: 12px; border-radius: 12px; font-size: 16px; line-height: 1.4; }
        .ex { align-self: flex-start; background: white; }
        .st { align-self: flex-end; background: #dcf8c6; }

        /* Espacio de respuesta reforzado */
        .input-area { background: white; padding: 20px; display: flex; gap: 10px; border-top: 2px solid var(--primary); padding-bottom: 50px; }
        input { flex: 1; padding: 15px; border-radius: 10px; border: 1px solid #ccc; font-size: 18px; }
        .action-btn { background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 10px; font-size: 20px; font-weight: bold; }
    </style>
</head>
<body>

<header>Se√±or Mart√≠n: LC Oral Prep</header>

<div class="selector">
    <div class="rp-btn" id="b1" onclick="start(1)">üè† C√°ceres</div>
    <div class="rp-btn" id="b2" onclick="start(2)">üíª √Åvila</div>
    <div class="rp-btn" id="b3" onclick="start(3)">üöê Caravana</div>
    <div class="rp-btn" id="b4" onclick="start(4)">‚ôªÔ∏è Ambiente</div>
    <div class="rp-btn" id="b5" onclick="start(5)">üöó Aver√≠a</div>
</div>

<div id="chat">
    <div class="bubble ex"><b>S√±r Mart√≠n:</b> Pulsa un tema arriba para empezar.</div>
</div>

<div class="input-area">
    <button class="action-btn" id="mic" onclick="runMic()">üéôÔ∏è</button>
    <input type="text" id="box" placeholder="Escribe aqu√≠...">
    <button class="action-btn" onclick="send()">‚ñ∂Ô∏è</button>
</div>

<script>
    let current = null;
    let step = 0;

    const data = {
        1: ["¬°Hola, d√≠game!", "¬øEn qu√© parte de la ciudad querr√≠as vivir?", "¬øPor qu√©?", "Es una ciudad peque√±a pero muy bonita. ¬øHas estado alguna vez en Extremadura?", "¬°Perfecto! Fin del examen."],
        2: ["Buenos d√≠as. ¬øQu√© le pasa a tu port√°til?", "¬°Qu√© mala suerte! ¬øTienes copia de seguridad?", "Puedo ofrec√©rtelo por 300 euros hoy mismo. ¬øTe interesa?", "¬øLo necesitas para el colegio?", "Terminado."],
        3: ["¬°Hola! ¬øQuieres alquilar una autocaravana?", "¬øQui√©n va a conducir?", "¬øTu madre tiene experiencia?", "¬øQu√© ciudades de Castilla-La Mancha quer√©is visitar?", "Completado."],
        4: ["¬°Hola! Pareces muy contento. ¬øPor qu√©?", "¬øEs importante prohibir los pl√°sticos?", "¬øQu√© materiales usar√≠as t√∫?", "¬øReciclas en casa?", "Finalizado."],
        5: ["¬°Hola! Debes estar entre Medina del Campo y Tordesillas. ¬øVes se√±ales?", "Dime c√≥mo es tu coche.", "¬øLlevas mucho tiempo esperando?", "¬øEs la primera vez que te pasa?", "Suerte."]
    };

    function speak(txt) {
        window.speechSynthesis.cancel();
        let m = new SpeechSynthesisUtterance(txt);
        m.lang = 'es-ES';
        m.rate = 0.85;
        window.speechSynthesis.speak(m);
    }

    function start(id) {
        current = id; step = 0;
        document.querySelectorAll('.rp-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('b'+id).classList.add('active');
        document.getElementById('chat').innerHTML = "";
        next();
    }

    function next() {
        if (!current || step >= data[current].length) return;
        let t = data[current][step];
        let c = document.getElementById('chat');
        c.innerHTML += `<div class="bubble ex"><b>Examinador:</b> ${t}</div>`;
        speak(t);
        c.scrollTop = c.scrollHeight;
        step++;
    }

    function send() {
        let i = document.getElementById('box');
        if (!i.value) return;
        document.getElementById('chat').innerHTML += `<div class="bubble st">${i.value}</div>`;
        i.value = "";
        setTimeout(next, 1000);
    }

    function runMic() {
        let Reco = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!Reco) return alert("Micro no soportado");
        let r = new Reco();
        r.lang = 'es-ES';
        r.onstart = () => document.getElementById('mic').style.background = 'red';
        r.onresult = (e) => {
            document.getElementById('box').value = e.results[0][0].transcript;
            document.getElementById('mic').style.background = '#1a237e';
            send();
        };
        r.onerror = () => document.getElementById('mic').style.background = '#1a237e';
        r.start();
    }
</script>
</body>
</html>
