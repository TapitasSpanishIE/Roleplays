<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SEC Role Play Simulator</title>
    <style>
        :root { 
            --snap-yellow: #FFD700; 
            --snap-blue: #00b9ff;
            --snap-black: #1a1a1a;
            --bg-canvas: #ebebeb;
            --card-shadow: 0 10px 25px rgba(0,0,0,0.08);
        }
        
        html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; background: var(--bg-canvas); }
        body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; display: flex; flex-direction: column; }
        
        #modal-instrucciones { 
            position: fixed; top:0; left:0; width:100%; height:100%; 
            background: var(--snap-yellow); display:flex; align-items:center; 
            justify-content:center; z-index:9999; padding: 20px; box-sizing: border-box; 
        }
        .modal-content { 
            background: white; padding: 30px; border-radius: 40px; max-width: 450px; 
            width: 100%; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }
        .modal-content h1 { font-size: 2em; margin: 0 0 15px; color: var(--snap-black); font-weight: 900; }
        .modal-content ol { text-align: left; color: #444; font-size: 1.05em; line-height: 1.6; margin-bottom: 25px; padding-left: 25px; }
        
        header { 
            background: white; color: var(--snap-black); padding: 15px; text-align: center; 
            flex-shrink: 0; border-bottom: 4px solid var(--snap-yellow);
        }
        header h1 { margin: 0; font-size: 1.2em; font-weight: 900; text-transform: uppercase; }
        .sub-header { font-size: 0.8em; color: #666; margin-top: 4px; }
        .author-credit { font-size: 0.75em; color: var(--snap-blue); margin-top: 5px; font-weight: 700; }
        
        /* Bot√≥n sutil de donativo en header */
        .btn-support-header {
            display: inline-block; margin-top: 8px; padding: 6px 12px;
            background: #f8f8f8; border: 1px solid #ddd; border-radius: 20px;
            color: #555; text-decoration: none; font-size: 0.7em; font-weight: 700;
        }

        .selector { 
            display: flex; overflow-x: auto; gap: 12px; padding: 15px; 
            background: white; flex-shrink: 0; scrollbar-width: none;
        }
        .rp-btn { 
            min-width: 140px; padding: 12px 20px; background: #f0f0f0; 
            border: none; border-radius: 50px; font-size: 14px; 
            font-weight: 800; cursor: pointer; transition: 0.2s;
        }
        .active { background: var(--snap-yellow); color: black; transform: scale(1.05); }
        
        .main-container {
            flex-grow: 1; display: flex; flex-direction: column; 
            max-width: 600px; margin: 0 auto; width: 100%; height: 100%;
            background: white; box-shadow: var(--card-shadow); overflow: hidden;
        }

        #candidate-card { background: #fffef0; border-bottom: 2px solid #f0f0f0; padding: 20px; position: relative; }
        .card-context { font-weight: 800; color: var(--snap-blue); font-size: 0.75em; text-transform: uppercase; }
        .current-prompt { color: #1a1a1a; font-size: 1.1em; margin-top: 8px; font-weight: 700; line-height: 1.4; }
        
        #chat { 
            flex-grow: 1; overflow-y: auto; padding: 20px; display: flex; 
            flex-direction: column; gap: 15px; background: #ffffff;
            background-image: radial-gradient(#f2f2f2 1px, transparent 1px); background-size: 20px 20px;
        }
        .bubble { max-width: 80%; padding: 14px 18px; border-radius: 25px; font-size: 17px; line-height: 1.4; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .ex { align-self: flex-start; background: #f1f1f2; color: #1a1a1a; border-bottom-left-radius: 4px; border: 1px solid #e0e0e0; }
        .st { align-self: flex-end; background: var(--snap-blue); color: white; border-bottom-right-radius: 4px; }

        .feedback-box { font-size: 0.95em; background: #fff9c4; color: #6d4c41; padding: 15px; border-radius: 20px; border-left: 5px solid var(--snap-yellow); align-self: center; width: 85%; margin: 10px 0; }
        
        /* Tarjeta de cooperar al final */
        .cooperate-card {
            background: #f0f9ff; border: 2px dashed var(--snap-blue); border-radius: 25px;
            padding: 20px; margin: 15px 0; text-align: center; align-self: center; width: 85%;
            animation: fadeIn 0.5s ease;
        }
        .cooperate-card p { font-size: 0.9em; color: #333; line-height: 1.5; margin-bottom: 12px; }
        .btn-cooperate {
            display: inline-block; background: var(--snap-blue); color: white; 
            padding: 10px 20px; border-radius: 50px; text-decoration: none; 
            font-weight: 800; font-size: 0.9em;
        }

        #next-trigger { 
            display: none; margin: 15px auto; padding: 18px; background: #ff004b; color: white; 
            border: none; border-radius: 50px; font-weight: 900; cursor: pointer; width: 85%; font-size: 16px; 
            text-transform: uppercase; box-shadow: 0 8px 20px rgba(255, 0, 75, 0.3);
        }

        .input-area { background: white; padding: 15px 15px 40px; display: flex; gap: 10px; border-top: 2px solid #f0f0f0; }
        input { flex: 1; padding: 15px 22px; border-radius: 50px; border: 2px solid #eee; background: #f8f8f8; font-size: 17px; outline: none; }
        .btn-send { background: var(--snap-blue); color: white; border: none; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; font-size: 20px; }
        .btn-feedback { position: absolute; right: 20px; top: 20px; background: white; border: 2px solid #eee; border-radius: 50%; width: 40px; height: 40px; font-weight: bold; font-size: 18px; color: #999; }
        .btn-close { background: var(--snap-black); color: white; padding: 18px; border-radius: 50px; border: none; font-weight: 800; font-size: 1.1em; cursor: pointer; width: 100%; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div id="modal-instrucciones">
    <div class="modal-content">
        <h1>SEC Simulator</h1>
        <ol>
            <li><b>Select</b> a scenario from the top menu.</li>
            <li><b>Press the Red Button</b> to listen to the Examiner.</li>
            <li><b>Reply</b> by typing or using your microphone.</li>
            <li>Tap <b>"?"</b> for a model answer if you're stuck.</li>
            <li>Tap any white bubble to <b>replay</b> the audio.</li>
        </ol>
        <button class="btn-close" onclick="startApp()">START PRACTICE</button>
    </div>
</div>

<header>
    <h1>SEC Role Play Simulator</h1>
    <div class="sub-header">Interactive training for the Leaving Cert Spanish Role Play section</div>
    <div class="author-credit">Developed by Sr. Mart√≠n</div>
    <a href="https://revolut.me/davidkhy4" target="_blank" class="btn-support-header">‚ù§ Support this project</a>
</header>

<div class="selector">
    <div class="rp-btn" onclick="seleccionarRP(1, this)">üè† 1. Alojamiento</div>
    <div class="rp-btn" onclick="seleccionarRP(2, this)">üíª 2. Port√°til</div>
    <div class="rp-btn" onclick="seleccionarRP(3, this)">üöê 3. Camper van</div>
    <div class="rp-btn" onclick="seleccionarRP(4, this)">‚ôªÔ∏è 4. Pl√°sticos</div>
    <div class="rp-btn" onclick="seleccionarRP(5, this)">üöó 5. Aver√≠a</div>
</div>

<div class="main-container">
    <div id="candidate-card" style="display:none">
        <div class="card-context" id="card-context"></div>
        <div class="current-prompt" id="current-prompt">Ready!</div>
        <button class="btn-feedback" id="feedbackBtn" onclick="mostrarSugerencia()" style="display:none">?</button>
    </div>
    <div id="chat"></div>
    <button id="next-trigger" onclick="proximaIntervencion()">Press to listen üîä</button>
    <div class="input-area">
        <input type="text" id="userInput" placeholder="Select a scenario..." disabled>
        <button class="btn-send" id="sendBtn" onclick="enviarRespuesta()" disabled>‚û§</button>
    </div>
</div>

<script>
    let rpActual = null; let pasoActual = 0; let speaking = false;
    const database = {
        1: { context: "ERASMUS in C√°ceres. You call for accommodation.", prompts: ["1. Say you are going to C√°ceres on Erasmus next year and ask for advice on accommodation.", "2. Say you'd prefer to live near the university and mention your experience living in the Dublin outskirts last year.", "3. Explain that you spent too much time travelling and you'd prefer to spend that time studying to get good grades.", "4. Mention the climate is better than Ireland. Say you'll consider all areas but would prefer the centre.", "5. Answer the examiner's surprise question.", "Role Play Completed."], dialogs: ["¬°Hola, d√≠game!", "¬øEn qu√© parte de la ciudad querr√≠as vivir?", "¬øPor qu√©?", "Tienes raz√≥n. Pero sabes que C√°ceres es una ciudad muy peque√±a... ", ["¬øHas estado alguna vez en Espa√±a?", "¬øQu√© es lo que m√°s te gusta de Espa√±a?", "¬øPor qu√© estudiar en Espa√±a?"], "Hemos terminado, gracias"], sugerencias: ["Hola, voy a ir de ERASMUS el a√±o que viene. No conozco a nadie en C√°ceres ¬øPodr√≠a darme alg√∫n consejo sobre el alojamiento?", "Preferir√≠a vivir cerca de la universidad porque el a√±o pasado viv√≠ en las afueras de Dubl√≠n y no me gust√≥.", "Pues es que pasaba demasiado tiempo viajando. Si pudiera dedicar ese tiempo a estudiar, sacar√≠a mejores notas.", "Bueno, el clima es mucho mejor que en Irlanda, as√≠ que considerar√© todas las zonas aunque preferir√≠a el centro.", "(Respuesta libre)", ""] },
        2: { context: "Broken laptop in √Åvila. You are at a repair shop.", prompts: ["1. Explain your laptop fell and the screen is broken. Mention you have an essay due tomorrow.", "2. Say you were late for the bus, you slipped and only noticed the problem when you got up.", "3. Say it's good it can be fixed but you saw the same model in the window for ‚Ç¨300.", "4. Say you'll buy it if they copy your files to the new one and give you a free laptop bag.", "5. Answer the examiner's surprise question.", "Role Play Completed."], dialogs: ["¬°Hola! ¬øEn qu√© puedo ayudarte?", "Vamos a ver. ¬øQu√© te pas√≥?", "Vas a necesitar una nueva pantalla que cuesta doscientos euros.", "S√≠, hay una oferta especial esta semana. ¬øQuieres comprarlo?", ["¬øDe qu√© marca es tu ordenador?","¬øPara qu√© usas el ordenador normalmente?","¬øDe qu√© color te gustar√≠a la funda del ordenador?"], "Hemos terminado, gracias"], sugerencias: ["Se me cay√≥ el port√°til y la pantalla est√° rota. Lo peor es que tengo que entregar un ensayo ma√±ana y la √∫nica copia que tengo est√° en mi port√°til.", "Llegaba tarde y tuve que correr para coger el autob√∫s. Me resbal√© y el port√°til se cay√≥ al suelo y me di cuenta del problema en cuanto me levant√©.", "Es bueno saber que tiene arreglo pero he visto un port√°til del mismo modelo y la misma marca a la venta en el escaparate y solo cuesta trescientos euros.", "Lo comprar√© si puedes copiar todos mis archivos al nuevo disco duro antes de salir de la tienda y si me das un bolso gratis para el port√°til.", "(Respuesta libre)", ""] },
        3: { context: "Hiring a camper van for a family holiday in Spain.", prompts: ["1. Say you are a student calling from Ireland and want to hire a camper van for 2 weeks in July.", "2. Explain your mother will be driving. Say you are taking lessons and hope to pass in the Autumn.", "3. Say she has driven on the right in Europe for 20 years and is a very careful driver.", "4. Mention you want to see the land of Cervantes (Castilla-La Mancha) far from the tourists.", "5. Answer the examiner's surprise question.", "Role Play Completed."], dialogs: ["¬°Hola! ¬øEn qu√© puedo ayudarte?", "Para alquilar un c√°mper hace falta tener al menos veinticinco a√±os y mucha experiencia al volante.", "Pues, muy bien. Tu madre cumple con los requisitos para alquilar un c√°mper.", "¬°Fenomenal! Os alquilo un c√°mper. ¬øTen√©is el itinerario previsto?", ["¬øA qu√© hora vais a recoger el c√°mper?", "¬øQu√© tipo de m√∫sica os gusta escuchar en el coche?", "¬øQu√© ciudades te gustar√≠a visitar en vuestro viaje?"], "Hemos terminado, gracias"], sugerencias: ["Soy estudiante y llamo desde Irlanda, me interesa alquilar un c√°mper durante dos semanas en julio.", "Mi madre va a conducir porque yo todav√≠a no tengo el carn√© de conducir. Estoy yendo a clases de conducir y espero aprobar el examen en oto√±o.", "Ha conducido por la derecha en varios pa√≠ses europeos durante los √∫ltimos veinte a√±os. Es una conductora muy prudente y nunca ha tenido un accidente.", "Hemos pasado mucho tiempo en la costa, pero este verano nos gustar√≠a viajar por Castilla-La Mancha para ver la tierra de Cervantes y Don Quijote, lejos de los turistas.", "(Respuesta libre)", ""] },
        4: { context: "Discussion about single-use plastics and pollution.", prompts: ["1. Mention the EU has agreed to ban single-use plastics like knives, straws, and cups.", "2. Explain this is essential for the planet's waters and is a serious problem in rivers and oceans.", "3. Suggest using recycled paper, cardboard, and other biodegradable materials instead.", "4. Say we must be responsible and change our lifestyle by cycling or using public transport.", "5. Answer the examiner's surprise question.", "Role Play Completed."], dialogs: ["Pareces muy contento, ¬øpor qu√©?", "¬øEs importante prohibir pl√°sticos de usar y tirar?", "¬øPodemos hacer algo m√°s?", "Y, ¬øya est√°?", ["¬øQu√© cosas reciclas t√∫ en tu casa?", "¬øQu√© haces t√∫ para ayudar al medioambiente?", "¬øQu√© transporte usas para venir al instituto?"], "Hemos terminado, gracias"], sugerencias: ["El Parlamento Europeo ha convenido prohibir los pl√°sticos de un solo uso, por ejemplo, los cuchillos, los tenedores, las cucharas, las tazas, los platos y las pajitas.", "S√≠, es absolutamente imprescindible. Ser√° muy bueno para las aguas del planeta. La contaminaci√≥n causada por los pl√°sticos es un problema grave en r√≠os, lagos y oc√©anos.", "Hay muchas cosas que podemos hacer. Por ejemplo, en vez de usar pl√°sticos, podemos usar papel reciclado, cart√≥n y otros materiales biodegradables.", "No, como ciudadanos necesitamos ser m√°s responsables y cambiar nuestro estilo de vida. Para proteger el medio ambiente podr√≠amos ir en bicicleta, usar el transporte p√∫blico o caminar m√°s a menudo.", "(Respuesta libre)", ""] },
        5: { context: "Car breakdown on the AP-6 highway. Calling insurance.", prompts: ["1. Explain the car has broken down on the AP-6 and you passed the toll half an hour ago.", "2. Say you can see exit sign 156 and ask to send a mechanic or a tow truck.", "3. Ask for a replacement car to continue your journey to Lugo to collect your parents.", "4. Describe the car: Red Seat Ibiza, plate 4620 CFK, bought from your aunt.", "5. Answer the examiner's surprise question.", "Role Play Completed."], dialogs: ["Hola, buenas tardes.", "Debes estar entre Medina del Campo y Tordesillas. ¬øHay alguna se√±al de tr√°fico por ah√≠?", "Claro que s√≠. Voy a arreglarlo todo inmediatamente.", "Por supuesto. ¬øMe puedes describir tu coche?", ["¬øCu√°ntas personas viajan contigo en el coche?", "¬øQu√© ciudades te gustar√≠a visitar?", "¬øCu√°nto cost√≥ el coche?"], "Hemos terminado, gracias"], sugerencias: ["Mi coche acaba de averiarse y estoy en la autopista AP-6. No s√© exactamente donde estoy pero pas√© por el peaje hace media hora.", "Puedo ver la se√±al de salida 156 a lo lejos. ¬øPueden enviar un mec√°nico o quiz√°s una gr√∫a? Es que creo que el problema es serio.", "¬øPodr√≠an darme un coche de sustituci√≥n para que pueda seguir mi viaje a Lugo? Tengo que recoger a mis padres en el aeropuerto de Santiago de Compostela.", "Es un Seat Ibiza rojo. La matr√≠cula es 4620 CFK. Se lo compr√© de segunda mano a mi t√≠a y nunca he tenido un problema con √©l antes.", "(Respuesta libre)", ""] }
    };

    function startApp() { new Audio().play().catch(()=>{}); document.getElementById('modal-instrucciones').style.display = 'none'; }
    function setInputEnabled(e) { const input = document.getElementById('userInput'); input.disabled = !e; document.getElementById('sendBtn').disabled = !e; document.getElementById('feedbackBtn').style.display = e ? "block" : "none"; input.placeholder = e ? "Type your reply here..." : "Wait for examiner..."; if(e) input.focus(); }
    function seleccionarRP(id, btn) { rpActual = id; pasoActual = 0; speaking = false; document.querySelectorAll('.rp-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); document.getElementById('candidate-card').style.display = "block"; document.getElementById('card-context').innerHTML = database[id].context; document.getElementById('chat').innerHTML = ""; document.getElementById('current-prompt').innerHTML = "Tap the RED BUTTON to begin."; document.getElementById('next-trigger').style.display = "block"; setInputEnabled(false); }
    function mostrarSugerencia() { const sug = database[rpActual]?.sugerencias[pasoActual]; if(sug) { const fb = document.createElement('div'); fb.className = 'feedback-box'; fb.innerHTML = `üí° <b>Model Answer:</b> ${sug}`; document.getElementById('chat').appendChild(fb); document.getElementById('chat').scrollTop = document.getElementById('chat').scrollHeight; } }
    function enviarRespuesta() { const input = document.getElementById('userInput'); const text = input.value.trim(); if (!text || speaking) return; document.getElementById('chat').innerHTML += `<div class="bubble st">${text}</div>`; input.value = ""; document.getElementById('chat').scrollTop = document.getElementById('chat').scrollHeight; setInputEnabled(false); pasoActual++; setTimeout(() => { document.getElementById('next-trigger').style.display = "block"; }, 300); }
    function reproducirAudio(path, fallbackText) { window.speechSynthesis.cancel(); const audio = new Audio(path); const onEndAction = () => { speaking = false; if(pasoActual < (database[rpActual].dialogs.length - 1)) { setInputEnabled(true); } else { mostrarCooperar(); } }; audio.play().then(() => { audio.onended = onEndAction; }).catch(() => { const msg = new SpeechSynthesisUtterance(fallbackText); msg.lang = 'es-ES'; msg.onend = onEndAction; window.speechSynthesis.speak(msg); }); }
    function proximaIntervencion() { if (!rpActual || speaking) return; document.getElementById('next-trigger').style.display = "none"; speaking = true; let dialogText = database[rpActual].dialogs[pasoActual]; let audioFile = ""; if (Array.isArray(dialogText)) { let randomIndex = Math.floor(Math.random() * dialogText.length); dialogText = dialogText[randomIndex]; audioFile = `rp${rpActual}_5${['a','b','c'][randomIndex]}.mp3`; } else { audioFile = `rp${rpActual}_${pasoActual + 1}.mp3`; } const chat = document.getElementById('chat'); const bubble = document.createElement('div'); bubble.className = "bubble ex"; bubble.innerHTML = `<b>Examiner:</b> ${dialogText}`; bubble.onclick = () => reproducirAudio(audioFile, dialogText); chat.appendChild(bubble); document.getElementById('current-prompt').innerHTML = `<b>Prompt:</b> ${database[rpActual].prompts[pasoActual]}`; chat.scrollTop = chat.scrollHeight; reproducirAudio(audioFile, dialogText); }
    
    function mostrarCooperar() {
        if(document.getElementById('coop-card')) return;
        const chat = document.getElementById('chat');
        const card = document.createElement('div');
        card.id = "coop-card";
        card.className = "cooperate-card";
        card.innerHTML = `
            <p>Espero que esta herramienta te sea muy √∫til. Si quieres, puedes cooperar con un donativo para apoyar esta iniciativa y poder crear m√°s herramientas para JC y LC.</p>
            <a href="https://revolut.me/davidkhy4" target="_blank" class="btn-cooperate">Cooperar con el proyecto</a>
        `;
        chat.appendChild(card);
        chat.scrollTop = chat.scrollHeight;
    }
</script>
</body>
</html>
