<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LC Oral Master - Se√±or Mart√≠n</title>
    <style>
        :root { --primary: #1a237e; --secondary: #c62828; }
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; background: #fff; }
        
        header { background: var(--primary); color: white; padding: 10px; text-align: center; flex-shrink: 0; }
        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px; padding: 8px; background: #f0f0f0; flex-shrink: 0; }
        .card { background: white; border-radius: 4px; padding: 10px 2px; text-align: center; cursor: pointer; font-size: 0.7rem; border: 1px solid #ccc; font-weight: bold; }
        .card.active { background: var(--secondary); color: white; }

        #chat { flex-grow: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; background-color: #e5ddd5; }
        .bubble { max-width: 85%; padding: 12px; border-radius: 15px; font-size: 16px; box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .ex { align-self: flex-start; background: white; border-bottom-left-radius: 2px; }
        .st { align-self: flex-end; background: #dcf8c6; border-bottom-right-radius: 2px; }

        /* AJUSTE PARA IPAD: M√°s alto y con margen inferior */
        .controls { 
            background: white; 
            padding: 20px 15px 40px 15px; /* Mucho margen abajo para que no se corte */
            display: flex; 
            gap: 10px; 
            border-top: 2px solid var(--primary); 
            flex-shrink: 0; 
        }
        input { flex: 1; padding: 15px; border-radius: 25px; border: 1px solid #bbb; font-size: 16px; }
        .btn-circle { background: var(--primary); color: white; border: none; width: 55px; height: 55px; border-radius: 50%; font-size: 24px; display: flex; justify-content: center; align-items: center; }
    </style>
</head>
<body>

<header><h1 style="margin:0; font-size: 1rem;">Se√±or Mart√≠n: Simulador Oral SEC</h1></header>

<div class="grid">
    <div class="card" id="rp1" onclick="initRP(1)">üè† Aloj.</div>
    <div class="card" id="rp2" onclick="initRP(2)">üíª Port.</div>
    <div class="card" id="rp3" onclick="initRP(3)">üöê Carav.</div>
    <div class="card" id="rp4" onclick="initRP(4)">‚ôªÔ∏è Amb.</div>
    <div class="card" id="rp5" onclick="initRP(5)">üöó Aver.</div>
</div>

<div id="chat">
    <div class="bubble ex"><b>Se√±or Mart√≠n:</b> Bienvenido. Selecciona un Role Play para empezar.</div>
</div>

<div class="controls">
    <button class="btn-circle" id="mic-btn" onclick="activarMicro()">üéôÔ∏è</button>
    <input type="text" id="userInput" placeholder="Responde aqu√≠...">
    <button class="btn-circle" onclick="procesarRespuesta()">‚ñ∂Ô∏è</button>
</div>

<script>
    let currentRP = null; let step = 0;
    const scriptData = {
        [span_2](start_span)1: ["¬°Hola, d√≠game!", "¬øEn qu√© parte de la ciudad querr√≠as vivir?", "¬øPor qu√©?", "Tienes raz√≥n. Pero sabes que C√°ceres es una ciudad muy peque√±a y se puede andar a la Plaza Mayor en media hora[span_2](end_span).", "¬øHas estado alguna vez en Extremadura?", "Examen terminado."],
        2: ["¬°Hola! [span_3](start_span)¬øEn qu√© puedo ayudarte?[span_3](end_span)[span_4](start_span)", "¬øQu√© le ha pasado exactamente a la pantalla?[span_4](end_span)", "¬°Qu√© mala suerte! [span_5](start_span)¬øTienes una copia de seguridad?[span_5](end_span)", "Tengo una oferta: un port√°til nuevo igual al tuyo por trescientos euros. [span_6](start_span)[span_7](start_span)¬øQuieres comprarlo?[span_6](end_span)[span_7](end_span)", "¬øNecesitas el ordenador para el colegio?", "Buen trabajo."],
        3: ["Hola, buenos d√≠as. [span_8](start_span)¬øQuieres alquilar una autocaravana?[span_8](end_span)[span_9](start_span)", "¬øQui√©n va a conducir la caravana?[span_9](end_span)[span_10](start_span)", "¬øTu madre tiene mucha experiencia al volante?[span_10](end_span)", "Castilla-La Mancha es preciosa. [span_11](start_span)¬øQu√© ciudades quer√©is visitar?[span_11](end_span)", "¬øCu√°ntos sois en total?", "Role Play completado."],
        [span_12](start_span)4: ["Pareces muy contento, ¬øpor qu√©?[span_12](end_span)", "Es una noticia fant√°stica. [span_13](start_span)[span_14](start_span)¬øEs importante prohibir los pl√°sticos de usar y tirar?[span_13](end_span)[span_14](end_span)[span_15](start_span)", "¬øQu√© otros materiales podr√≠amos usar?[span_15](end_span)[span_16](start_span)", "¬øCrees que los ciudadanos debemos cambiar nuestro estilo de vida?[span_16](end_span)[span_17](start_span)", "¬øHaces t√∫ algo para proteger el medioambiente?[span_17](end_span)", "Terminado."],
        [span_18](start_span)5: ["¬°Hola, buenas tardes[span_18](end_span)!", "Debes estar entre Medina del Campo y Tordesillas. [span_19](start_span)[span_20](start_span)¬øVes alguna se√±al por ah√≠?[span_19](end_span)[span_20](end_span)", "Voy a ayudarte. [span_21](start_span)[span_22](start_span)¬øMe puedes describir tu coche?[span_21](end_span)[span_22](end_span)[span_23](start_span)", "¬øEs la primera vez que tienes una aver√≠a con este coche?[span_23](end_span)", "El mec√°nico llegar√° pronto. ¬°Suerte!"]
    };

    function hablar(t) { window.speechSynthesis.cancel(); const m = new SpeechSynthesisUtterance(t); m.lang = 'es-ES'; m.rate = 0.8; window.speechSynthesis.speak(m); }
    function initRP(id) { currentRP = id; step = 0; document.querySelectorAll('.card').forEach(c => c.classList.remove('active')); document.getElementById('rp'+id).classList.add('active'); document.getElementById('chat').innerHTML = ""; avanzarExamen(); }
    function avanzarExamen() { if (!currentRP || step >= scriptData[currentRP].length) return; const f = scriptData[currentRP][step]; const chat = document.getElementById('chat'); chat.innerHTML += `<div class="bubble ex"><b>Examinador:</b> ${f}</div>`; hablar(f); chat.scrollTop = chat.scrollHeight; step++; }
    function procesarRespuesta() { const i = document.getElementById('userInput'); if (!i.value) return; document.getElementById('chat').innerHTML += `<div class="bubble st">${i.value}</div>`; i.value = ""; setTimeout(avanzarExamen, 1200); }
    function activarMicro() { const r = new (window.webkitSpeechRecognition || window.Recognition)(); r.lang = 'es-ES'; r.onstart = () => document.getElementById('mic-btn').style.background = 'red'; r.onresult = (e) => { document.getElementById('userInput').value = e.results[0][0].transcript; document.getElementById('mic-btn').style.background = '#1a237e'; setTimeout(procesarRespuesta, 500); }; r.start(); }
</script>
</body>
</html>
